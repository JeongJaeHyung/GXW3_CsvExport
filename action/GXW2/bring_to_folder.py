import shutil
import glob
import core
import os



def work():
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("--------------------------------------C S V   M O V E   S T A R T--------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    print("-------------------------------------------------------------------------------------------------------")
    username = os.getlogin()
    # 1. 와일드카드가 포함된 패턴 정의
    pattern = rf"C:\Users\{username}\Documents\*.csv"
    target = core.CURRENT_EXPORT_DIR #
    
    # 2. glob.glob을 사용하여 패턴과 일치하는 모든 파일 경로 리스트를 가져옴
    files = glob.glob(pattern)
    
    if not files:
        print("│  └─ [Skip] 옮길 .csv 파일이 없습니다.")
        return

    for source_file in files:
        try:
            # 파일 하나씩 이동 실행
            shutil.move(source_file, target)
            print(f"│  └─ [Success] Moved: {os.path.basename(source_file)}")
        except Exception as e:
            print(f"│  └─ [Error] Failed to move {source_file}: {e}")